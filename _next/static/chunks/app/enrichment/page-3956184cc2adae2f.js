(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[838],{8818:function(e,t,n){Promise.resolve().then(n.bind(n,8797))},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},8797:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(7437),a=n(2265),s=n(9376),c=n(7268);function i(){let e=(0,s.useSearchParams)(),t=(0,s.useRouter)(),[n,i]=(0,a.useState)([]),[u,d]=(0,a.useState)(""),[h,m]=(0,a.useState)("up"),[f,p]=(0,a.useState)(null),[g,y]=(0,a.useState)(!0),[j,b]=(0,a.useState)(!1),[v,N]=(0,a.useState)("chart"),[w,_]=(0,a.useState)(20);(0,a.useEffect)(()=>{(0,c.vj)().then(t=>{var n;i(t),d(e.get("comparison")||(null===(n=t[0])||void 0===n?void 0:n.id)||""),m(e.get("direction")||"up"),y(!1)})},[e]),(0,a.useEffect)(()=>{u&&h&&(b(!0),(0,c.zW)(u,h).then(p).catch(()=>p(null)).finally(()=>b(!1)))},[u,h]);let P=(e,n)=>{d(e),m(n),t.push("/enrichment?comparison=".concat(e,"&direction=").concat(n),{scroll:!1})},S=(0,a.useMemo)(()=>(null==f?void 0:f.data)?[...f.data].sort((e,t)=>(e["Adjusted P-value"]||1)-(t["Adjusted P-value"]||1)).slice(0,w):[],[f,w]);return g?(0,r.jsx)(x,{}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"GO Enrichment Analysis"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-3 space-y-3",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-1.5",children:n.map(e=>(0,r.jsx)("button",{onClick:()=>P(e.id,h),className:"px-3 py-1.5 rounded text-xs font-medium ".concat(u===e.id?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-purple-100"),children:e.name.replace(/_/g," ")},e.id))}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex space-x-0.5 bg-gray-100 rounded p-0.5",children:[(0,r.jsx)("button",{onClick:()=>P(u,"up"),className:"px-3 py-1.5 rounded text-xs font-medium ".concat("up"===h?"bg-red-500 text-white":"text-gray-600"),children:"Upregulated"}),(0,r.jsx)("button",{onClick:()=>P(u,"down"),className:"px-3 py-1.5 rounded text-xs font-medium ".concat("down"===h?"bg-blue-500 text-white":"text-gray-600"),children:"Downregulated"})]}),(0,r.jsx)("select",{value:w,onChange:e=>_(Number(e.target.value)),className:"px-2 py-1.5 border border-gray-300 rounded text-xs outline-none",children:[10,15,20,30,50].map(e=>(0,r.jsxs)("option",{value:e,children:["Top ",e]},e))}),(0,r.jsxs)("div",{className:"flex space-x-0.5 bg-gray-100 rounded p-0.5 ml-auto",children:[(0,r.jsx)("button",{onClick:()=>N("chart"),className:"px-2 py-1 rounded text-xs font-medium ".concat("chart"===v?"bg-white shadow-sm":"text-gray-500"),children:"Chart"}),(0,r.jsx)("button",{onClick:()=>N("table"),className:"px-2 py-1 rounded text-xs font-medium ".concat("table"===v?"bg-white shadow-sm":"text-gray-500"),children:"Table"})]})]})]}),j?(0,r.jsx)(x,{}):S.length>0?(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-3",children:[null==f?void 0:f.total_terms," enriched terms (",null==f?void 0:f.go_type,")"]}),"chart"===v?(0,r.jsx)(o,{terms:S,direction:h}):(0,r.jsx)(l,{terms:S})]}):(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center text-sm text-gray-500",children:"No enrichment data available for this selection."})]})}function o(e){let{terms:t,direction:n}=e,a="up"===n?"#ef4444":"#3b82f6",s=Math.max(...t.map(e=>-Math.log10(e["Adjusted P-value"]||1))),c=22*t.length+30;return(0,r.jsxs)("svg",{viewBox:"0 0 ".concat(740," ").concat(c),className:"w-full",style:{maxHeight:"700px"},children:[(0,r.jsx)("text",{x:490,y:c-4,textAnchor:"middle",fontSize:10,fill:"#6b7280",children:"-log₁₀(Adj. P-value)"}),t.map((e,t)=>{let n=-Math.log10(e["Adjusted P-value"]||1),c=n/s*380,i=22*t+6,o=u(e.Term||"");return(0,r.jsxs)("g",{children:[(0,r.jsx)("text",{x:294,y:i+9+3.5,textAnchor:"end",fontSize:9,fill:"#4b5563",children:o.length>55?o.slice(0,52)+"...":o}),(0,r.jsx)("rect",{x:300,y:i,width:c,height:18,fill:a,rx:2,opacity:.8}),(0,r.jsx)("text",{x:300+c+4,y:i+9+3.5,fontSize:8,fill:"#9ca3af",children:n.toFixed(1)})]},t)})]})}function l(e){let{terms:t}=e;return(0,r.jsxs)("table",{className:"w-full text-xs border-collapse",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,r.jsx)("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600 w-6",children:"#"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600",children:"Term"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-right font-semibold text-gray-600 w-16",children:"Overlap"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-right font-semibold text-gray-600 w-24",children:"P-value"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-right font-semibold text-gray-600 w-24",children:"Adj. P"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-right font-semibold text-gray-600 w-16",children:"OR"}),(0,r.jsx)("th",{className:"px-2 py-1.5 text-left font-semibold text-gray-600",children:"Genes"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-2 py-1 text-gray-400",children:t+1}),(0,r.jsx)("td",{className:"px-2 py-1 text-gray-900 font-medium max-w-xs",children:u(e.Term||"")}),(0,r.jsx)("td",{className:"px-2 py-1 text-right text-gray-600 font-mono tabular-nums",children:e.Overlap||"-"}),(0,r.jsx)("td",{className:"px-2 py-1 text-right text-gray-600 font-mono tabular-nums",children:d(e["P-value"])}),(0,r.jsx)("td",{className:"px-2 py-1 text-right text-gray-600 font-mono tabular-nums",children:d(e["Adjusted P-value"])}),(0,r.jsx)("td",{className:"px-2 py-1 text-right text-gray-600 font-mono tabular-nums",children:e["Odds Ratio"]?e["Odds Ratio"].toFixed(1):"-"}),(0,r.jsx)("td",{className:"px-2 py-1 text-gray-500 max-w-[200px] truncate",title:e.Genes,children:e.Genes?e.Genes.split(";").slice(0,5).join(", ")+(e.Genes.split(";").length>5?"...":""):"-"})]},t))})]})}function u(e){return e.replace(/^GOBP_/,"").replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())}function d(e){return null==e?"-":e<.001?e.toExponential(2):e.toFixed(4)}function x(){return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[40vh]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})})}function h(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(x,{}),children:(0,r.jsx)(i,{})})}},7268:function(e,t,n){"use strict";n.d(t,{Eh:function(){return h},I5:function(){return l},Ji:function(){return m},Mw:function(){return d},Z4:function(){return y},_r:function(){return u},ex:function(){return f},rY:function(){return p},sd:function(){return i},vj:function(){return o},wK:function(){return g},zW:function(){return x}});let r=()=>"/mrnapp-intersection",a=new Map;async function s(e){if(a.has(e))return a.get(e);let t=r(),n="".concat(t).concat(e),s=await fetch(n);if(!s.ok)throw Error("Failed to fetch ".concat(n,": ").concat(s.statusText));let c=await s.json();return a.set(e,c),c}async function c(e){return s(e)}async function i(){return c("/data/metadata.json")}async function o(){return c("/data/differential/comparison_list.json")}async function l(e){return c("/data/differential/results/".concat(e,".json"))}async function u(e){return c("/data/differential/volcano/".concat(e,".json"))}async function d(e){return c("/data/differential/significant/".concat(e,".json"))}async function x(e,t){return c("/data/enrichment/go/".concat(e).concat(t?"_".concat(t):"",".json"))}async function h(){return c("/data/intersection/index.json")}async function m(){return c("/data/intersection/gene_sets_summary.json")}function f(e){return[...e].sort().join("__")}async function p(e,t){let n=f(e);return c("/data/intersection/pairs/".concat(n,"_").concat(t,".json"))}async function g(e,t){let n=f(e);return c("/data/intersection/enrichment/".concat(n,"_").concat(t,"_enrichment.json"))}async function y(){return c("/data/gene-search/all_genes.json")}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8818)}),_N_E=e.O()}]);